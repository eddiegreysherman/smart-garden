{% extends "base.html" %} 
{% block content %}
<div class="row mb-4">
    <div class="col-md-8 offset-md-2 text-center">
        <h1 class="display-4">Welcome to Smart Garden Settings üëã</h1>
        <p class="lead">How are you today {{current_user.username}}?</p>
    </div>
</div>

<div class="row">
    <div class="col-md-10 offset-md-1">
        <div class="card bg-dark text-light shadow-sm">
            <div class="card-header">
                <h4 class="mb-0">Smart Garden Settings</h4>
            </div>
            <div class="card-body">
                <!-- Tabs Navigation -->
                <ul class="nav nav-tabs mb-4" id="settingsTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active text-light" id="temperature-tab" data-bs-toggle="tab" data-bs-target="#temperature" type="button" role="tab" aria-controls="temperature" aria-selected="true">
                            <span class="emoji">üå°Ô∏è</span> Temperature
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link text-light" id="humidity-tab" data-bs-toggle="tab" data-bs-target="#humidity" type="button" role="tab" aria-controls="humidity" aria-selected="false">
                            <span class="emoji">üíß</span> Humidity
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link text-light" id="co2-tab" data-bs-toggle="tab" data-bs-target="#co2" type="button" role="tab" aria-controls="co2" aria-selected="false">
                            <span class="emoji">üçÉ</span> CO2
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link text-light" id="light-tab" data-bs-toggle="tab" data-bs-target="#light" type="button" role="tab" aria-controls="light" aria-selected="false">
                            <span class="emoji">‚òÄÔ∏è</span> Light Schedule
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link text-light" id="user-tab" data-bs-toggle="tab" data-bs-target="#user" type="button" role="tab" aria-controls="user" aria-selected="false">
                            <span class="emoji">üë§</span> User Settings
                        </button>
                    </li>
                </ul>

                <!-- Tabs Content -->
                <div class="tab-content" id="settingsTabsContent">
                    <!-- Temperature Settings -->
<div class="tab-pane fade show active" id="temperature" role="tabpanel" aria-labelledby="temperature-tab">
    <form method="POST" action="{{ url_for('main.settings') }}">
        {{ temperature_form.csrf_token }}
        {{ temperature_form.setting_type }}
        <div class="row">
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    {{ temperature_form.temp_min.label(class="form-label") }}
                    {{ temperature_form.temp_min(class="form-control bg-dark text-light", min="0", max="40", step="0.1") }}
                    <div class="form-text text-light">Alert will trigger if temperature drops below this value</div>
                    {% if temperature_form.temp_min.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in temperature_form.temp_min.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    {{ temperature_form.temp_max.label(class="form-label") }}
                    {{ temperature_form.temp_max(class="form-control bg-dark text-light", min="10", max="50", step="0.1") }}
                    <div class="form-text text-light">Alert will trigger if temperature rises above this value</div>
                    {% if temperature_form.temp_max.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in temperature_form.temp_max.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            {{ temperature_form.submit(class="btn btn-primary") }}
        </div>
    </form>
</div>

                    <!-- Humidity Settings -->
                    <div class="tab-pane fade" id="humidity" role="tabpanel" aria-labelledby="humidity-tab">
                        <form method="POST" action="{{ url_for('main.settings') }}">
                            <input type="hidden" name="setting_type" value="humidity">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="humidity_min" class="form-label">Minimum Humidity (%)</label>
                                        <input type="number" class="form-control bg-dark text-light" id="humidity_min" name="humidity_min" min="0" max="100" step="1" value="40" required>
                                        <div class="form-text text-light">Alert will trigger if humidity drops below this value</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="humidity_max" class="form-label">Maximum Humidity (%)</label>
                                        <input type="number" class="form-control bg-dark text-light" id="humidity_max" name="humidity_max" min="0" max="100" step="1" value="80" required>
                                        <div class="form-text text-light">Alert will trigger if humidity rises above this value</div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-primary">Save Humidity Settings</button>
                            </div>
                        </form>
                    </div>

                    <!-- CO2 Settings -->
                    <div class="tab-pane fade" id="co2" role="tabpanel" aria-labelledby="co2-tab">
                        <form method="POST" action="{{ url_for('main.settings') }}">
                            <input type="hidden" name="setting_type" value="co2">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="co2_min" class="form-label">Minimum CO2 (ppm)</label>
                                        <input type="number" class="form-control bg-dark text-light" id="co2_min" name="co2_min" min="300" max="2000" step="10" value="400" required>
                                        <div class="form-text text-light">Alert will trigger if CO2 drops below this value</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="co2_max" class="form-label">Maximum CO2 (ppm)</label>
                                        <input type="number" class="form-control bg-dark text-light" id="co2_max" name="co2_max" min="500" max="5000" step="10" value="1500" required>
                                        <div class="form-text text-light">Alert will trigger if CO2 rises above this value</div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-primary">Save CO2 Settings</button>
                            </div>
                        </form>
                    </div>

                    <!-- Light Schedule Settings -->
                    <div class="tab-pane fade" id="light" role="tabpanel" aria-labelledby="light-tab">
                        <form method="POST" action="{{ url_for('main.settings') }}">
                            <input type="hidden" name="setting_type" value="light">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="light_on" class="form-label">Lights On Time</label>
                                        <input type="time" class="form-control bg-dark text-light" id="light_on" name="light_on" value="06:00" required>
                                        <div class="form-text text-light">Time when lights should turn on</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="light_off" class="form-label">Lights Off Time</label>
                                        <input type="time" class="form-control bg-dark text-light" id="light_off" name="light_off" value="20:00" required>
                                        <div class="form-text text-light">Time when lights should turn off</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="light_intensity" class="form-label">Light Intensity (%)</label>
                                        <input type="range" class="form-range" id="light_intensity" name="light_intensity" min="0" max="100" step="5" value="75">
                                        <div class="d-flex justify-content-between">
                                            <span class="form-text text-light">Low</span>
                                            <span class="form-text text-light" id="intensity_value">75%</span>
                                            <span class="form-text text-light">High</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-check form-switch mt-4">
                                        <input class="form-check-input" type="checkbox" id="auto_adjust" name="auto_adjust" checked>
                                        <label class="form-check-label" for="auto_adjust">Auto-adjust light cycles seasonally</label>
                                    </div>
                                </div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-primary">Save Light Settings</button>
                            </div>
                        </form>
                    </div>

                    <!-- User Settings -->
                    <div class="tab-pane fade" id="user" role="tabpanel" aria-labelledby="user-tab">
                        <form method="POST" action="{{ url_for('main.settings') }}">
                            <input type="hidden" name="setting_type" value="user">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="email" class="form-label">Email Address</label>
                                        <input type="email" class="form-control bg-dark text-light" id="email" name="email" value="{{ current_user.email }}" required>
                                        <div class="form-text text-light">Your email for alerts and notifications</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="notification_frequency" class="form-label">Notification Frequency</label>
                                        <select class="form-select bg-dark text-light" id="notification_frequency" name="notification_frequency">
                                            <option value="immediate">Immediate</option>
                                            <option value="hourly">Hourly</option>
                                            <option value="daily" selected>Daily</option>
                                            <option value="weekly">Weekly</option>
                                        </select>
                                        <div class="form-text text-light">How often you want to receive alert notifications</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="password" class="form-label">New Password</label>
                                        <input type="password" class="form-control bg-dark text-light" id="password" name="password">
                                        <div class="form-text text-light">Leave blank to keep current password</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="password2" class="form-label">Confirm New Password</label>
                                        <input type="password" class="form-control bg-dark text-light" id="password2" name="password2">
                                        <div class="form-text text-light">Repeat your new password</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="enable_notifications" name="enable_notifications" checked>
                                        <label class="form-check-label" for="enable_notifications">Enable Email Notifications</label>
                                    </div>
                                </div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-primary">Save User Settings</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div> <!-- end of card-body -->
        </div> <!-- end of card -->
    </div> <!-- end of col-md-10 -->
</div> <!-- end of row -->

{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get the slider and display elements
        const intensitySlider = document.getElementById('light_intensity');
        const intensityValue = document.getElementById('intensity_value');
        
        // Update value display on page load
        intensityValue.textContent = intensitySlider.value + '%';
        
        // Update value display when slider changes
        intensitySlider.addEventListener('input', function() {
            intensityValue.textContent = this.value + '%';
        });
    });
</script>
{% endblock %}
